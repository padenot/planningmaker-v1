<?
  isset($_POST['id_categorie']) ? $id_categorie = $_POST['id_categorie'] : $id_categorie = "";
  if ($id_categorie=="")  {    $req_sql="SELECT MIN(id_categorie) FROM categories";    $req = mysql_query($req_sql);    while ($data = mysql_fetch_array($req))    {      $id_categorie=$data['MIN(id_categorie)'];    }  }  $req_sql="SELECT taches.*, lieux.nom_lieu, orgas.first_name, orgas.last_name FROM taches, lieux, orgas WHERE taches.id_categorie='".$id_categorie."' AND taches.id_lieu=lieux.id_lieu AND taches.id_resp=orgas.id_orga ORDER BY taches.titre";  $req_taches = mysql_query($req_sql);  $req_sql="SELECT * FROM categories WHERE type_categorie='tache' ORDER BY nom_categorie";  $req_categories = mysql_query($req_sql);?><TABLE WIDTH="1%" CELLSPACING="0" CELLPADDING="3"><FORM method="POST" name="form" action="main.php?file=taches&action=cat">  <TR>    <TD colspan="6">&nbsp;</TD>  </TR>  <TR CLASS="taches_top">    <TD colspan="6" nowrap>      <B>Choisis une cat&eacute;gorie</B>&nbsp;&nbsp;&nbsp;      <SELECT NAME="id_categorie" onChange="document.form.submit()"><?  $categories_array=result_categories($req_categories);  for ($i=0;$i<count($categories_array);$i++)  {    $is_selected="";    if ($categories_array[$i]->id_categorie==$id_categorie) $is_selected="selected";?>        <OPTION <? print($is_selected); ?> VALUE="<? print($categories_array[$i]->id_categorie); ?>"><? print($categories_array[$i]->nom); ?></OPTION><?  }?>      </SELECT>    </TD>  </TR>  <TR CLASS="taches_top">    <TD COLSPAN="2" nowrap>      <B>Liste des t&acirc;ches</B>    </TD>    <TD ALIGN="center">      <B>Horaires</B>    </TD>    <TD ALIGN="center">      <B>Responsable</B>    </TD>    <TD ALIGN="center">      <B>Lieu</B>    </TD>  </TR><?  $taches_array=result_taches($req_taches);  for ($i=0;$i<count($taches_array);$i++)  {?>  <TR CLASS="taches">      <TD width="1%">&nbsp;&nbsp;&nbsp;</TD>    <TD VALIGN="top" nowrap>      <? print($taches_array[$i]->titre); ?>    </TD>    <TD ALIGN="center" nowrap>            <?    $list_plages=explode("|",$taches_array[$i]->plages);	$nb_plages=count($list_plages)-2;    for ($j=0;$j<$nb_plages;$j++)	{	  if ($j!=0) print("<BR>");	  print(list_to_begin_plage($list_plages[$j+1])." à ".list_to_end_plage($list_plages[$j+1]));    }?>    </TD>    <TD ALIGN="center" VALIGN="top" nowrap>      <? print($taches_array[$i]->nom_orga); ?>    </TD>    <TD ALIGN="center" VALIGN="top" nowrap>      <? print($taches_array[$i]->nom_lieu); ?>    </TD>  </TR><?  }?></FORM></TABLE>